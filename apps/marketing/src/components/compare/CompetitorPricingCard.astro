---
import type { BackupTool } from "@config/comparison";
import XIcon from "@lucide/astro/icons/x";

type Props = {
  tool: BackupTool;
};

const { tool } = Astro.props;

const pricing = tool.pricing;
const hasFreeTier = pricing.freeTier && "supported" in pricing.freeTier && pricing.freeTier.supported === true;
const startingPrice = pricing.startingPrice && "text" in pricing.startingPrice ? pricing.startingPrice.text : null;
const startingPriceNote = pricing.startingPrice && "note" in pricing.startingPrice ? pricing.startingPrice.note : null;
const hasUnlimited = pricing.unlimitedStorage && "supported" in pricing.unlimitedStorage && pricing.unlimitedStorage.supported === true;
const unlimitedNote = pricing.unlimitedStorage && "note" in pricing.unlimitedStorage ? pricing.unlimitedStorage.note : null;
const hasByos = pricing.byoStorage && "supported" in pricing.byoStorage && pricing.byoStorage.supported === true;
---

<div class="flex flex-col gap-4">
  <div class="rounded-xl border bg-card p-4">
    <div class="mb-3 text-center">
      <div class="text-2xl font-bold">{startingPrice ?? "Contact"}</div>
      {startingPriceNote && (
        <p class="text-xs text-muted-foreground">{startingPriceNote}</p>
      )}
    </div>

    <ul class="space-y-2 text-sm">
      {hasFreeTier && (
        <li class="flex items-center gap-2 text-muted-foreground">
          <span class="size-4 text-center text-primary">✓</span>
          Free tier available
        </li>
      )}
      {hasUnlimited && (
        <li class="flex items-center gap-2 text-muted-foreground">
          <span class="size-4 text-center text-primary">✓</span>
          Unlimited storage{unlimitedNote && ` (${unlimitedNote})`}
        </li>
      )}
      {!hasByos && (
        <li class="flex items-center gap-2 text-muted-foreground">
          <XIcon class="size-4 text-destructive" />
          No bring-your-own storage
        </li>
      )}
    </ul>
  </div>
</div>

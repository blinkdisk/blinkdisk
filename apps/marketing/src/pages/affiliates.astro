---
import BaseLayout from "@/layouts/BaseLayout.astro";
import Navigation from "@/components/Navigation.astro";
import Footer from "@/components/Footer.astro";
import { plans } from "@config/plans";
import {
  ArrowRightIcon,
  ClockIcon,
  CookieIcon,
  DollarSignIcon,
} from "lucide-react";

const commission = 0.3;
const duration = 12;

const mostExpensivePlan = plans
  .map((plan) =>
    plan.prices
      .filter((plan) => plan.period === "MONTHLY")
      .reduce((a, b) => {
        return a.amount > b.amount ? a : b;
      }),
  )
  .reduce((a, b) => {
    return a.amount > b.amount ? a : b;
  });

const maxEarnings = Math.floor(mostExpensivePlan.amount * 12 * commission);
const formattedEarnings = maxEarnings.toLocaleString("en-US", {
  style: "currency",
  currency: "USD",
  minimumFractionDigits: 0,
});
const formattedCommission = commission.toLocaleString("en-US", {
  style: "percent",
});
---

<BaseLayout
  title="Affiliate Program"
  description="Join the BlinkDisk Affiliate Program in minutes and earn generous commissions for every customer you refer."
>
  <Navigation />
  <div class="py-page flex min-h-screen flex-col items-center">
    <div class="mt-auto"></div>
    <div
      class="w-content mx-auto flex max-w-4xl flex-col items-center text-center"
    >
      <div class="flex flex-col items-center">
        <a
          href="https://affiliate.watch/?ref=blinkdisk"
          target="_blank"
          rel="noreferrer"
        >
          <img
            src="/images/affiliate-badge.svg"
            class="w-40 opacity-80 dark:invert"
            alt="Affiliate Badge"
          />
        </a>
        <h1
          class="mt-6 text-5xl font-bold leading-tight tracking-tight md:text-6xl"
        >
          Earn up to {formattedEarnings}
          <br class="hidden sm:block" />
          for each referral
        </h1>
        <p class="text-muted-foreground sm:w-lg mt-6 text-base sm:text-lg">
          Join the BlinkDisk Affiliate Program in minutes and earn generous
          commissions for every customer you refer.
        </p>
      </div>

      <a
        href="https://blinkdisk.endorsely.com/"
        target="_blank"
        rel="noopener noreferrer"
        class="bg-primary text-primary-foreground hover:bg-primary/90 mt-10 inline-flex h-12 items-center justify-center gap-2 rounded-lg px-6 text-base font-medium transition-colors"
      >
        Join Affiliate Program
        <ArrowRightIcon className="ml-2 size-5" />
      </a>

      <div class="mt-16 grid w-full grid-cols-1 gap-6 sm:mt-20 md:grid-cols-3">
        <div
          class="bg-card flex flex-col items-center rounded-xl border p-6 text-center"
        >
          <div class="text-primary mb-4 [&_svg]:size-8">
            <DollarSignIcon className="size-8" />
          </div>
          <h3 class="text-foreground text-2xl font-bold">
            {formattedCommission} Commission
          </h3>
          <p class="text-muted-foreground mt-2 text-sm">
            Earn {formattedCommission} commission on all referrals for 12 months
          </p>
        </div>
        <div
          class="bg-card flex flex-col items-center rounded-xl border p-6 text-center"
        >
          <div class="text-primary mb-4 [&_svg]:size-8">
            <ClockIcon className="size-8" />
          </div>
          <h3 class="text-foreground text-2xl font-bold">
            {duration} Month Duration
          </h3>
          <p class="text-muted-foreground mt-2 text-sm">
            Your commission continues for a full year on each referral
          </p>
        </div>
        <div
          class="bg-card flex flex-col items-center rounded-xl border p-6 text-center"
        >
          <div class="text-primary mb-4 [&_svg]:size-8">
            <CookieIcon className="size-8" />
          </div>
          <h3 class="text-foreground text-2xl font-bold">90 Day Cookie</h3>
          <p class="text-muted-foreground mt-2 text-sm">
            90-day cookie tracking ensures you get credit for your referrals
          </p>
        </div>
      </div>
    </div>
    <div class="mb-auto"></div>
  </div>
  <Footer />
</BaseLayout>
